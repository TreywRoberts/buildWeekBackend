exports.up = (knex) => {
  return knex.schema
    .createTable('users', (users) => {
      users.increments('user_id')
      users.string('user_username').notNullable().unique()
      users.string('user_password').notNullable()
      users.string('user_email').notNullable()
    })
    .createTable('trucks', trucks=>{
      trucks.increments('truck_id')
      trucks.string('truck_name').notNullable()
      trucks.string('cuisine_type').notNullable()
      trucks.integer('user_id')
        .unsigned()
        .notNullable()
        .references('user_id')
        .inTable('users')
        .onUpdate('CASCADE')
        .onDelete('CASCADE')
    })
    .createTable('menu', menu=>{
      menu.increments('menu_id')
      menu.string('menu_name')
      menu.string('menu_description')
      menu.integer('menu_price')
      menu.integer('truck_id')
        .unsigned()
        .notNullable()
        .references('truck_id')
        .inTable('trucks')
        .onUpdate('CASCADE')
        .onDelete('CASCADE')
    })
    .createTable("favorites", (favorites) => {
      favorites.increments("favorite_id");
      favorites
        .integer("user_id")
        .unsigned()
        .notNullable()
        .references("user_id")
        .inTable("users")
        .onDelete("CASCADE")
        .onUpdate("CASCADE");
      favorites
        .integer("truck_id")
        .unsigned()
        .notNullable()
        .references("truck_id")
        .inTable("trucks")
        .onDelete("CASCADE")
        .onUpdate("CASCADE");
    })
    .createTable('menu_ratings', tbl=>{
      tbl.increments('menu_rating_id')
      tbl.integer('menu_rating')
      tbl.integer('menu_id')
      .unsigned()
      .notNullable()
      .references('menu_id')
      .inTable('menu')
      .onUpdate('CASCADE')
      .onDelete('CASCADE')
      tbl.integer('user_id')
        .unsigned()
        .notNullable()
        .references('user_id')
        .inTable('users')
        .onUpdate('CASCADE')
        .onDelete('CASCADE')
        tbl.integer('truck_id')
        .unsigned()
        .notNullable()
        .references('truck_id')
        .inTable('trucks')
        .onUpdate('CASCADE')
        .onDelete('CASCADE')
    })
    .createTable('truck_ratings', tbl=>{
      tbl.increments('truck_rating_id')
      tbl.string('truck_rating')
      tbl.integer('user_id')
        .unsigned()
        .notNullable()
        .references('user_id')
        .inTable('users')
        .onUpdate('CASCADE')
        .onDelete('CASCADE')
        tbl.integer('truck_id')
        .unsigned()
        .notNullable()
        .references('truck_id')
        .inTable('trucks')
        .onUpdate('CASCADE')
        .onDelete('CASCADE')
    })
  }

    

exports.down = (knex) => {
  return knex.schema
  .dropTableIfExists('truck_ratings')
  .dropTableIfExists('menu_ratings')
  .dropTableIfExists('favorites')
  .dropTableIfExists('menu')
  .dropTableIfExists('trucks')
  .dropTableIfExists('users')
}
